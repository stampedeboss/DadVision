<!--
     Feed parser test project
-->
<project name="VideoLibrary" default="compile">

    <taskdef resource="pyAntTasks.properties"/>

    <property name="src.dir" value="daddyvision"/>
    <property name="pydoc.dir" value="docs"/>
    
    <!--
        Initialize anything needed for build.
    -->
    <target name="init">
        <mkdir dir="${pydoc.dir}"/>
    </target>
    
    <!--
        Clean out any compiled code or files generated by the build.
    -->
    <target name="clean" depends="init">
        <delete>
            <fileset dir="${src.dir}">
                <include name="**/*.pyc"/>
                <include name="**/*.pyo"/>
            </fileset>
            <fileset dir="${pydoc.dir}">
                <include name="**/*"/>
            </fileset>
        </delete>
    </target>
    
    <!--
        Compile the Python source under src
    -->
    <target name="compile">
        <py-compile dir="${src.dir}" optimize="0" pythonpath="${src.dir}"/>
    </target>

    <!--
        Run the feedparser module, fetching some RSS content from
        a website (requires internet connection).
    -->
    <target name="run.daddyvision">
        <py-run script="${src.dir}/daddyvision.py" pythonpath="${src.dir}" optimize="0">
            <arg value="/mnt/TV"/>
        </py-run>
    </target>

    
    <!--
        Generate documentation for the project.
        Generate pydocs for every python module under src
    -->
    <target name="pydoc" depends="init,compile">
        <py-doc pythonpath="${src.dir}" destdir="${pydoc.dir}">
            <fileset dir="${src.dir}">
                <include name="**/*"/>
            </fileset>
        </py-doc>
    </target>

    <!--
        Execute Python unit tests.
        This will treat any files under src/ that end in Test.py as a Python
        unit test module.
    -->
    <target name="tests" depends="compile">
        <py-test pythonpath="${src.dir}" dir=".">
            <fileset dir="${src.dir}">
                <include name="**/*Test.py"/>
            </fileset>
        </py-test>
    </target>
  
</project>
